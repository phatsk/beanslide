javascript:(function(){//%20==UserScript==%0A//%20@name%20%20%20%20%20%20%20%20%20Beanstalk%20Niceties%0A//%20@namespace%20%20%20%20http://github.com/phatsk%0A//%20@version%20%20%20%20%20%200.1%0A//%20@description%20%20Does%20some%20things%20to%20make%20beanstalk%20nicer...%0A//%20@author%20%20%20%20%20%20%20You%0A//%20@match%20%20%20%20%20%20%20%20https://*.beanstalkapp.com/*%0A//%20@grant%20%20%20%20%20%20%20%20none%0A//%20==/UserScript==%0A%0A(function()%20%7B%0A%20%20%20%20'use%20strict';%0A%0A%09var%20href%20%20%20=%20window.location.href;%0A%09var%20bs_url%20=%20%5B%20window.location.host,%20window.location.pathname.split('/')%5B1%5D%20%5D.join('/')%20+%20'/';%0A%09var%20$%20%20%20%20%20%20=%20$%20%7C%7C%20window.jQuery;%0A%09var%20_noJq%20%20=%20!%20(%20window.jQuery%20);%0A%0A%09/**%0A%09%20*%20Changeset%20pages.%0A%09%20*/%0A%09if%20(%20href.match(%20'changesets'%20)%20)%20%7B%0A%09%09/**%0A%09%09%20*%20Find%20the%20branch%20names%20at%20the%20top%20of%20a%20changeset%20list%20and%20turn%20them%20into%20hyperlinks.%0A%09%09%20*/%0A%09%09var%20b%20=%20document.getElementsByClassName('i-branch');%0A%09%09var%20a;%0A%09%09var%20i;%0A%09%09for(%20i%20=%20b.length;%20i--;%20)%7B%0A%09%09%09a%20%20%20%20%20%20%20%20%20%20%20%20%20%20=%20document.createElement('a');%0A%09%09%09a.href%20%20%20%20%20%20%20%20%20=%20'https://'%20+%20bs_url%20+%20'/browse/git?ref=b-';%0A%09%09%09a.href%20%20%20%20%20%20%20%20+=%20encodeURIComponent(%20b%5Bi%5D.innerText%20);%0A%09%09%09a.innerText%20%20%20%20=%20b%5Bi%5D.innerText;%0A%09%09%09b%5Bi%5D.innerHTML%20=%20a.outerHTML;%0A%09%09%7D%0A%0A%09%09/**%0A%09%09%20*%20@TODO%20This%20can%20be%20done%20easily%20enough%20in%20VanillaJS.%0A%09%09%20*/%0A%09%09if%20(%20!%20_noJq%20)%20%7B%0A%09%20%20%20%20%20%20%20%20//%20Make%20commit%20headers%20copy-able%20links%0A%09%09%09$('h2.cs-message').html('%3Ca%20href=%22'%20+%20href%20+%20'%22%3E%20'%20+%20$('h2.cs-message').html()%20+%20'%3C/a%3E'%20);%0A%09%09%7D%0A%09%7D%0A%0A%09/**%0A%09%20*%20Branch%20comparison%20pages.%0A%09%20*/%0A%09if%20(%20href.match(%20/compare%7Ccode_reviews/%20)%20)%20%7B%0A%09%09if%20(%20!%20_noJq%20)%20%7B%0A%09%09%09/**%0A%09%09%09*%20Beanslide.js%0A%09%09%09*%0A%09%09%09*%20-%20Allows%20rolling%20up%20files%20in%20Beanstalk's%20Change%20view%0A%09%09%09*%20-%20Auto-hides%20patterns%20matched%20in%20%60mask%60%0A%09%09%09*%20-%20Click%20a%20file's%20header%20row%20to%20hide/show%0A%09%09%09*/%0A%0A%09%09%09/**%0A%09%09%09%20*%20Files%20that%20match%20patterns%20in%20this%20array%20will%20be%20slid%20up%20and%20hidden.%0A%09%09%09%20*/%0A%09%09%09var%20mask%20=%20%5B%0A%09%09%09%09'%5E%5C%5C.*',%20%20%20%20%20%20%20%20%20//%20Hide%20%22hidden%22%20files%20that%20start%20with%20%22.%22.%0A%09%09%09%09'README.*',%20%20%20%20%20%20//%20Hide%20README%20files.%0A%09%09%09%09'package.json',%20%20//%20NPM.%0A%09%09%09%09'gruntfile.js',%20%20//%20Grunt.%0A%09%09%09%09'bower.json',%20%20%20%20//%20Bower.%0A%09%09%09%09'%5C%5C.pot',%20%20%20%20%20%20%20%20//%20WordPress%20.pot%20files.%0A%09%09%09%09'.*css.map',%20%20%20%20%20//%20CSS%20Map%20files.%0A%09%09%09%09'.*%5C%5C.min%5C%5C..*',%20//%20Minified%20files.%0A%09%09%09%09'%5C%5C.(m%7Cp)o'%20%20%20%20%20%20//%20MO/PO%20translation%20files.%0A%09%09%09%5D;%0A%0A%09%09%09//%20Make%20sure%20we%20can%20override.%0A%09%09%09if%20(%20!%20window.Browse%20%7C%7C%20!%20window.Browse.init%20%7C%7C%20(%20'function'%20!==%20typeof%20window.Browse.init%20)%20)%20%7B%0A%09%09%09%09return;%0A%09%09%09%7D%0A%0A%09%09%09//%20See%20if%20we%20need%20to%20override.%0A%09%09%09if%20(%20window.Browse._hasBSOverride%20)%20%7B%0A%09%09%09%09return;%0A%09%09%09%7D%0A%0A%09%09%09window.Browse._hasBSOverride%20=%20true;%0A%09%09%09//%20Override%20the%20change%20browser's%20init%20method.%0A%09%09%09window.Browse._BSInit%20%20%20%20%20%20%20%20=%20window.Browse.init;%0A%09%09%09window.Browse.init%20=%20function()%20%7B%0A%09%09%09%09window.Browse._BSInit();%0A%0A%09%09%09%09//%20Bind%20the%20beanslide%20method%0A%09%09%09%09$(%20'.cv-container%20.ct%20.ct_path'%20).off(%20'click'%20).on(%20'click',%20beanslide);%0A%0A%09%09%09%09//%20Hide%20matches%20in%20mask%0A%09%09%09%09$(%20'.cv-container%20.ct%20.ct_path'%20).children(%20'a.path_item.path_item--current'%20).each(%20function(%20index,%20el%20)%20%7B%0A%09%09%09%09%09var%20h%20=%20$(el).attr(%20'href'%20).split(%20'/'%20).pop().split(%20'?'%20)%5B0%5D;%0A%09%09%09%09%09if%20(%20maskmatch(h)%20)%20%7B%0A%09%09%09%09%09%09$(el).parents(%20'.cv-container'%20).children(%20'.cv'%20).addClass(%20'hidden'%20).slideUp();%0A%09%09%09%09%09%7D%0A%09%09%09%09%7D);%0A%0A%09%09%09%09/**%0A%09%09%09%09%20*%20Toggle%20file%20slide%20up/down%20when%20clicking%20on%20a%20file's%20header%0A%09%09%09%09%20*/%0A%09%09%09%09function%20beanslide()%20%7B%0A%09%09%09%09%09/**%0A%09%09%09%09%09%20*%20@TODO%20Use%20of%20%60this%60%20here%20is%20a%20possible%20strict%20violation.%0A%09%09%09%09%09%20*/%0A%09%09%09%09%09var%20n%20=%20$(this).parents(%20'.cv-container'%20).children(%20'.cv'%20);%0A%09%09%09%09%09if%20(%20n.hasClass(%20'hidden'%20)%20)%20%7B%0A%09%09%09%09%09%09n.slideDown();%0A%09%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09%09n.slideUp();%0A%09%09%09%09%09%7D%0A%0A%09%09%09%09%09n.toggleClass(%20'hidden'%20);%0A%09%09%09%09%7D%0A%0A%09%09%09%09/**%0A%09%09%09%09%20*%20See%20if%20a%20string%20matches%20the%20mask.%0A%09%09%09%09%20*%0A%09%09%09%09%20*%20@param%20String%20s%20The%20string%20to%20test%0A%09%09%09%09%20*%20@return%20Boolean%0A%09%09%09%09%20*/%0A%09%09%09%09function%20maskmatch(%20s%20)%20%7B%0A%09%09%09%09%09var%20regex%20=%20new%20RegExp(%20'',%20'i'%20);%0A%09%09%09%09%09var%20i;%0A%0A%09%09%09%09%09for%20(%20i%20=%20mask.length;%20i--;%20)%20%7B%0A%09%09%09%09%09%09regex.compile(%20mask%5B%20i%20%5D,%20'i'%20);%0A%09%09%09%09%09%09if%20(%20s.match(regex)%20&&%20s.match(regex)%5B0%5D%20!==%20''%20)%20%7B%0A%09%09%09%09%09%09%09return%20true;%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%7D%0A%0A%09%09%09%09%09return%20false;%0A%09%09%09%09%7D%0A%09%09%09%7D;%0A%09%09%7D%0A%09%7D%0A%7D)();%0A})();